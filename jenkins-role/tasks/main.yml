---
 #- name: add key for docker
 #  apt_key:
 #    url: https://download.docker.com/linux/ubuntu/gpg
  #   state: present

 # - name: Add doker repository
  #  apt_repository:
  #    repo: 'deb https://download.docker.com/linux/ubuntu bionic stable'
  #    state: present

  #- name: updating system
  #  apt:
  #    upgrade: yes
 #     update_cache: yes

 - name: installing docker
   apt: 
     name: docker.io 
     state: latest

 - name: Add user ubuntu to "docker" group
   user:
     name: ubuntu
     groups: "docker"
     append: true
      
 - name: applying new group for user
   command: "newgrp docker"

 - name: copy Dockerfile
   copy:
     src: Dockerfile
     dest: /tmp/final_task/Dockerfile

 - name: copy list of plugins
   copy:
     src: plugins.txt
     dest: /tmp/final_task/plugins.txt

 - name: installing python-docker
   apt: 
     name: python-docker 
     state: latest

 - name: build jenkins image
   docker_image:
     name: jenkins-for-final-task
     build:
       path: /tmp/final_task/
     source: build
     state: present

 - name: starting container from image
   docker_container:
     name: jenkins-for-final-task-container
     image: jenkins-for-final-task
     ports:
       - "8080:8080"
     state: started
#      command: cat /var/jenkins_home/secrets/initialAdminPassword
#      volumes:
#        - jenkins_home:/home/ubuntu/jenkins_home